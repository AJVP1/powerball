<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Powerball Drawings</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <h1>Powerball Drawings</h1>
      <p class="subtitle">List of played powerball drawings.</p>

      <div class="layout">
        <!-- LEFT: FORM -->
        <section class="card" aria-label="Create or edit drawing">
          <h2 id="form-title">New drawing</h2>
          <form id="drawing-form">
            <div class="field">
              <label for="title">Drawing label / name</label>
              <input
                type="text"
                id="title"
                name="title"
                placeholder="Example: Wednesday drawing #1"
                required
              />
            </div>

            <div class="field">
              <label for="date">Drawing date</label>
              <input type="date" id="date" name="date" required />
            </div>

            <div class="field">
              <label for="numbers">Numbers (generated or manual)</label>
              <div class="inline">
                <input
                  type="text"
                  id="numbers"
                  name="numbers"
                  placeholder="e.g. 05 12 27 48 52 + 16"
                  autocomplete="off"
                />
                <button
                  type="button"
                  class="btn btn-secondary btn-sm"
                  id="btn-generate"
                >
                  Generate
                </button>
              </div>
            </div>

            <div class="field">
              <label for="notes">Notes</label>
              <textarea
                id="notes"
                name="notes"
                placeholder="Strategy, odds, or any notes about this drawing..."
              ></textarea>
            </div>

            <div class="form-actions">
              <div>
                <button type="submit" class="btn btn-primary" id="btn-submit">
                  Save drawing
                </button>
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="btn-cancel-edit"
                  style="display: none"
                >
                  Cancel edit
                </button>
              </div>
              <p class="status-text">
                Mode: <span id="mode-label">Create</span>
              </p>
            </div>
          </form>
        </section>

        <!-- RIGHT: LIST -->
        <section class="card" aria-label="Saved drawings">
          <div class="list-header">
            <h2>Saved drawings</h2>
            <div class="filters" aria-label="Filter drawings">
              <button class="chip chip-active" data-filter="all">All</button>
              <button class="chip" data-filter="pending">Pending</button>
              <button class="chip" data-filter="completed">Completed</button>
            </div>
          </div>
          <div class="list" id="drawing-list"></div>
          <div class="list-empty" id="empty-state" style="display: none">
            No drawings yet. Add your first one on the left.
          </div>
        </section>
      </div>
    </div>

    <script>
      // ================================
      // DATA MODEL + STORAGE
      // ================================

      /**
       * Drawing structure example:
       * {
       *   id: 'uuid-string',
       *   title: 'Wednesday drawing',
       *   date: '2025-11-24',
       *   numbers: '05 12 27 48 52 + 16',
       *   notes: 'anything...',
       *   completed: false
       * }
       */

      const STORAGE_KEY = "powerball-drawings-todo";

      let draws = [];
      let editingId = null;
      let currentFilter = "all";

      const form = document.getElementById("drawing-form");
      const titleInput = document.getElementById("title");
      const dateInput = document.getElementById("date");
      const numbersInput = document.getElementById("numbers");
      const notesInput = document.getElementById("notes");

      const submitBtn = document.getElementById("btn-submit");
      const cancelEditBtn = document.getElementById("btn-cancel-edit");
      const formTitle = document.getElementById("form-title");
      const modeLabel = document.getElementById("mode-label");

      const drawingList = document.getElementById("drawing-list");
      const emptyState = document.getElementById("empty-state");

      const chipButtons = document.querySelectorAll(".chip");
      const generateBtn = document.getElementById("btn-generate");

      // Load from localStorage on start
      init();

      function init() {
        try {
          const saved = localStorage.getItem(STORAGE_KEY);
          if (saved) {
            draws = JSON.parse(saved);
          }
        } catch (err) {
          console.error("Failed to parse saved drawings", err);
          draws = [];
        }
        renderList();
      }

      function saveToStorage() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(draws));
      }

      // ================================
      // FORM HANDLING
      // ================================

      form.addEventListener("submit", (event) => {
        event.preventDefault();

        const title = titleInput.value.trim();
        const date = dateInput.value;
        const numbers = numbersInput.value.trim();
        const notes = notesInput.value.trim();

        if (editingId) {
          updateDrawing(editingId, { title, date, numbers, notes });
        } else {
          createDrawing({ title, date, numbers, notes });
        }

        clearForm();
        renderList();
        saveToStorage();
      });

      cancelEditBtn.addEventListener("click", () => {
        clearForm();
      });

      function createDrawing({ title, date, numbers, notes }) {
        const newDraw = {
          id: crypto.randomUUID ? crypto.randomUUID() : String(Date.now()),
          title,
          date,
          numbers,
          notes,
          completed: false,
        };
        draws.unshift(newDraw); // newest first
      }

      function updateDrawing(id, { title, date, numbers, notes }) {
        const index = draws.findIndex((d) => d.id === id);
        if (index === -1) return;
        draws[index] = {
          ...draws[index],
          title,
          date,
          numbers,
          notes,
        };
      }

      function clearForm() {
        form.reset();
        editingId = null;
        submitBtn.textContent = "Save drawing";
        cancelEditBtn.style.display = "none";
        formTitle.textContent = "New drawing";
        modeLabel.textContent = "Create";
      }

      function fillFormForEdit(draw) {
        titleInput.value = draw.title;
        dateInput.value = draw.date;
        numbersInput.value = draw.numbers || "";
        notesInput.value = draw.notes || "";
        editingId = draw.id;
        submitBtn.textContent = "Update drawing";
        cancelEditBtn.style.display = "inline-flex";
        formTitle.textContent = "Edit drawing";
        modeLabel.textContent = "Edit";
      }

      // ================================
      // LIST RENDERING + CRUD ACTIONS
      // ================================

      function renderList() {
        drawingList.innerHTML = "";

        const filtered = draws.filter((d) => {
          if (currentFilter === "pending") return !d.completed;
          if (currentFilter === "completed") return d.completed;
          return true; // all
        });

        if (filtered.length === 0) {
          emptyState.style.display = "block";
          return;
        } else {
          emptyState.style.display = "none";
        }

        filtered.forEach((draw) => {
          const item = document.createElement("article");
          item.className = "item";

          // Left: checkbox + main info
          const left = document.createElement("div");
          left.className = "item-left";

          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = draw.completed;
          checkbox.addEventListener("change", () => {
            toggleCompleted(draw.id, checkbox.checked);
          });

          const main = document.createElement("div");
          main.className = "item-main";

          const titleEl = document.createElement("div");
          titleEl.className = "item-title";
          if (draw.completed) {
            titleEl.classList.add("done");
          }
          titleEl.textContent = draw.title;

          const meta = document.createElement("div");
          meta.className = "item-meta";

          const dateSpan = document.createElement("span");
          dateSpan.textContent = draw.date || "No date";

          const statusSpan = document.createElement("span");
          statusSpan.textContent = draw.completed ? "Completed" : "Pending";

          meta.appendChild(dateSpan);
          meta.appendChild(statusSpan);

          const notesEl = document.createElement("div");
          notesEl.className = "item-notes";
          const numbersText = draw.numbers
            ? `Numbers: ${draw.numbers}`
            : "Numbers: (none yet)";
          const notesText = draw.notes ? ` – ${draw.notes}` : "";
          notesEl.textContent = numbersText + notesText;

          main.appendChild(titleEl);
          main.appendChild(meta);
          main.appendChild(notesEl);

          left.appendChild(checkbox);
          left.appendChild(main);

          // Right: actions
          const actions = document.createElement("div");
          actions.className = "item-actions";

          const editBtn = document.createElement("button");
          editBtn.className = "btn btn-secondary btn-sm";
          editBtn.textContent = "Edit";
          editBtn.addEventListener("click", () => fillFormForEdit(draw));

          const deleteBtn = document.createElement("button");
          deleteBtn.className = "btn btn-danger btn-sm";
          deleteBtn.textContent = "Delete";
          deleteBtn.addEventListener("click", () => {
            deleteDrawing(draw.id);
          });

          actions.appendChild(editBtn);
          actions.appendChild(deleteBtn);

          item.appendChild(left);
          item.appendChild(actions);

          drawingList.appendChild(item);
        });
      }

      function toggleCompleted(id, checked) {
        const index = draws.findIndex((d) => d.id === id);
        if (index === -1) return;
        draws[index].completed = checked;
        saveToStorage();
        renderList();
      }

      function deleteDrawing(id) {
        const index = draws.findIndex((d) => d.id === id);
        if (index === -1) return;
        draws.splice(index, 1);
        // If you were editing this one, reset form
        if (editingId === id) {
          clearForm();
        }
        saveToStorage();
        renderList();
      }

      // ================================
      // FILTERS
      // ================================

      chipButtons.forEach((chip) => {
        chip.addEventListener("click", () => {
          const filter = chip.getAttribute("data-filter");
          currentFilter = filter;

          chipButtons.forEach((c) => c.classList.remove("chip-active"));
          chip.classList.add("chip-active");

          renderList();
        });
      });

      // ================================
      // POWERBALL DRAWING LOGIC (YOU IMPLEMENT THIS PART)
      // ================================

      /**
       * This function is called when the user clicks "Generate".
       * You can replace its internal logic with your own algorithm
       * for generating Powerball numbers.
       *
       * It must return a STRING, because the UI expects a string to
       * be placed in the "numbers" input.
       *
       * Example Powerball format (US): 5 white balls 1–69 and
       * 1 red ball 1–26. Adapt as you like.
       */

      // Probabilidades
      const probN1 = {
        1: 0.085227273,
        2: 0.056818182,
        3: 0.039772727,
        4: 0.085227273,
        5: 0.096590909,
        6: 0.051136364,
        7: 0.068181818,
        8: 0.039772727,
        9: 0.0625,
        10: 0.017045455,
        11: 0.028409091,
        12: 0.039772727,
        13: 0.034090909,
        14: 0.022727273,
        15: 0.028409091,
        16: 0.022727273,
        17: 0.028409091,
        18: 0.017045455,
        19: 0.022727273,
        20: 0.017045455,
        21: 0.017045455,
        22: 0.011363636,
        23: 0.017045455,
        24: 0.017045455,
        25: 0.005681818,
        26: 0.017045455,
        27: 0.005681818,
        28: 0.005681818,
        29: 0.011363636,
        30: 0.011363636,
        31: 0.011363636,
        32: 0,
        33: 0.005681818,
        34: 0,
        35: 0,
        36: 0,
        37: 0,
        38: 0,
        39: 0,
        40: 0,
        41: 0,
        42: 0,
        43: 0,
        44: 0,
        45: 0,
        46: 0,
        47: 0,
        48: 0,
        49: 0,
        50: 0,
        51: 0,
        52: 0,
        53: 0,
        54: 0,
        55: 0,
        56: 0,
        57: 0,
        58: 0,
        59: 0,
        60: 0,
        61: 0,
        62: 0,
        63: 0,
        64: 0,
        65: 0,
        66: 0,
        67: 0,
        68: 0,
        69: 0,
      };

      const probN2 = {
        1: 0,
        2: 0.017045455,
        3: 0,
        4: 0.011363636,
        5: 0.005681818,
        6: 0.022727273,
        7: 0.022727273,
        8: 0.005681818,
        9: 0.034090909,
        10: 0.022727273,
        11: 0.039772727,
        12: 0.034090909,
        13: 0.011363636,
        14: 0.028409091,
        15: 0.017045455,
        16: 0.039772727,
        17: 0.022727273,
        18: 0.022727273,
        19: 0.028409091,
        20: 0.045454545,
        21: 0.028409091,
        22: 0.028409091,
        23: 0.028409091,
        24: 0.034090909,
        25: 0.028409091,
        26: 0.017045455,
        27: 0.034090909,
        28: 0.022727273,
        29: 0.034090909,
        30: 0.034090909,
        31: 0.028409091,
        32: 0.017045455,
        33: 0.034090909,
        34: 0.039772727,
        35: 0.022727273,
        36: 0.028409091,
        37: 0,
        38: 0.017045455,
        39: 0,
        40: 0.005681818,
        41: 0.011363636,
        42: 0.028409091,
        43: 0.005681818,
        44: 0.011363636,
        45: 0.005681818,
        46: 0,
        47: 0.005681818,
        48: 0.005681818,
        49: 0,
        50: 0,
        51: 0.005681818,
        52: 0,
        53: 0,
        54: 0,
        55: 0.005681818,
        56: 0,
        57: 0,
        58: 0,
        59: 0,
        60: 0,
        61: 0,
        62: 0,
        63: 0,
        64: 0,
        65: 0,
        66: 0,
        67: 0,
        68: 0,
        69: 0,
      };
      const probN3 = {
        1: 0,
        2: 0,
        3: 0.005681818,
        4: 0,
        5: 0,
        6: 0,
        7: 0.005681818,
        8: 0,
        9: 0.005681818,
        10: 0,
        11: 0.005681818,
        12: 0.011363636,
        13: 0.005681818,
        14: 0.005681818,
        15: 0.011363636,
        16: 0.005681818,
        17: 0,
        18: 0.011363636,
        19: 0.011363636,
        20: 0.005681818,
        21: 0.045454545,
        22: 0.011363636,
        23: 0.051136364,
        24: 0.011363636,
        25: 0.028409091,
        26: 0.011363636,
        27: 0.011363636,
        28: 0.022727273,
        29: 0.034090909,
        30: 0.039772727,
        31: 0.034090909,
        32: 0.028409091,
        33: 0.051136364,
        34: 0.011363636,
        35: 0.039772727,
        36: 0.022727273,
        37: 0.051136364,
        38: 0.005681818,
        39: 0.022727273,
        40: 0.039772727,
        41: 0.028409091,
        42: 0.011363636,
        43: 0.034090909,
        44: 0.051136364,
        45: 0.028409091,
        46: 0.017045455,
        47: 0.017045455,
        48: 0.022727273,
        49: 0,
        50: 0.017045455,
        51: 0.011363636,
        52: 0.017045455,
        53: 0.011363636,
        54: 0.005681818,
        55: 0.005681818,
        56: 0.011363636,
        57: 0.011363636,
        58: 0.005681818,
        59: 0.011363636,
        60: 0.005681818,
        61: 0,
        62: 0,
        63: 0.005681818,
        64: 0,
        65: 0,
        66: 0,
        67: 0.005681818,
        68: 0,
        69: 0,
      };
      const probN4 = {
        1: 0,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        6: 0,
        7: 0,
        8: 0,
        9: 0,
        10: 0,
        11: 0,
        12: 0,
        13: 0.005681818,
        14: 0,
        15: 0,
        16: 0,
        17: 0,
        18: 0.005681818,
        19: 0,
        20: 0,
        21: 0.005681818,
        22: 0,
        23: 0.017045455,
        24: 0.017045455,
        25: 0,
        26: 0.011363636,
        27: 0.017045455,
        28: 0.011363636,
        29: 0.017045455,
        30: 0.011363636,
        31: 0,
        32: 0.011363636,
        33: 0.017045455,
        34: 0.017045455,
        35: 0.022727273,
        36: 0.022727273,
        37: 0.022727273,
        38: 0.039772727,
        39: 0.051136364,
        40: 0.017045455,
        41: 0.005681818,
        42: 0.011363636,
        43: 0.034090909,
        44: 0.039772727,
        45: 0.034090909,
        46: 0.022727273,
        47: 0.034090909,
        48: 0.039772727,
        49: 0.017045455,
        50: 0.034090909,
        51: 0.028409091,
        52: 0.056818182,
        53: 0.022727273,
        54: 0.034090909,
        55: 0.028409091,
        56: 0.028409091,
        57: 0.017045455,
        58: 0.028409091,
        59: 0.005681818,
        60: 0.017045455,
        61: 0.022727273,
        62: 0.011363636,
        63: 0.011363636,
        64: 0.034090909,
        65: 0.005681818,
        66: 0.017045455,
        67: 0.011363636,
        68: 0.005681818,
        69: 0,
      };
      const probN5 = {
        1: 0,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        6: 0,
        7: 0,
        8: 0,
        9: 0,
        10: 0,
        11: 0,
        12: 0,
        13: 0,
        14: 0,
        15: 0,
        16: 0,
        17: 0,
        18: 0,
        19: 0,
        20: 0,
        21: 0,
        22: 0,
        23: 0,
        24: 0,
        25: 0,
        26: 0,
        27: 0,
        28: 0.005681818,
        29: 0,
        30: 0,
        31: 0.005681818,
        32: 0,
        33: 0,
        34: 0,
        35: 0.005681818,
        36: 0.005681818,
        37: 0,
        38: 0.011363636,
        39: 0.011363636,
        40: 0.005681818,
        41: 0,
        42: 0.005681818,
        43: 0.022727273,
        44: 0.011363636,
        45: 0.034090909,
        46: 0.022727273,
        47: 0.017045455,
        48: 0.005681818,
        49: 0.017045455,
        50: 0.011363636,
        51: 0.022727273,
        52: 0.039772727,
        53: 0.034090909,
        54: 0.022727273,
        55: 0.022727273,
        56: 0.028409091,
        57: 0.028409091,
        58: 0.028409091,
        59: 0.051136364,
        60: 0.039772727,
        61: 0.045454545,
        62: 0.056818182,
        63: 0.039772727,
        64: 0.051136364,
        65: 0.022727273,
        66: 0.045454545,
        67: 0.068181818,
        68: 0.039772727,
        69: 0.113636364,
      };
      const probPB = {
        1: 0.045454545,
        2: 0.039772727,
        3: 0.039772727,
        4: 0.045454545,
        5: 0.045454545,
        6: 0.028409091,
        7: 0.022727273,
        8: 0.034090909,
        9: 0.0625,
        10: 0.022727273,
        11: 0.022727273,
        12: 0.039772727,
        13: 0.039772727,
        14: 0.028409091,
        15: 0.045454545,
        16: 0.028409091,
        17: 0.017045455,
        18: 0.005681818,
        19: 0.039772727,
        20: 0.068181818,
        21: 0.073863636,
        22: 0.039772727,
        23: 0.022727273,
        24: 0.039772727,
        25: 0.079545455,
        26: 0.022727273,
      };

      // generate a random sample from a discrete distribution
      function sample(dist) {
        const entries = Object.entries(dist);
        let r = Math.random();
        console.log("Random number:", r);
        let cum = 0;

        for (const [key, p] of entries) {
          cum += p;
          if (r < cum) return Number(key);
        }
      }

      function generatePowerballNumbers() {
        // TODO: Replace this stub with your real drawing logic.
        // Below is just a SIMPLE example of random numbers,
        // so you can see how to wire it to the UI.

        const whiteCount = 5;
        const whiteMax = 69;
        const redMax = 26;

        const whiteBalls = new Set();
        const n1 = sample(probN1);
        whiteBalls.add(n1);
        const n2 = sample(probN2);
        whiteBalls.add(n2);
        const n3 = sample(probN3);
        whiteBalls.add(n3);
        const n4 = sample(probN4);
        whiteBalls.add(n4);
        const n5 = sample(probN5);
        whiteBalls.add(n5);

        const whiteArr = Array.from(whiteBalls).sort((a, b) => a - b);
        const red = sample(probPB);

        const fmt = (n) => String(n).padStart(2, "0");
        return whiteArr.map(fmt).join(" ") + " + " + fmt(red);
      }

      generateBtn.addEventListener("click", () => {
        const result = generatePowerballNumbers();
        if (typeof result === "string") {
          numbersInput.value = result;
        } else {
          console.warn(
            "generatePowerballNumbers() should return a string. Got:",
            result
          );
        }
      });
    </script>
  </body>
</html>
